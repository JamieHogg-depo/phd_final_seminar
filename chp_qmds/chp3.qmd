<!-- ----------------------------------------------------------------- -->
# Chapter 3/Paper 1
<br>
A two-stage Bayesian small area estimation approach for proportions
![](imgs/pillars_p1.png){width=80%}

<!-- ----------------------------------------------------------------- -->
## Paper submitted to *International Statistical Review*
<br>
**James Hogg**, Jessica Cameron, Susanna Cramb, Peter Baade, Kerrie Mengersen. A two-stage Bayesian small area estimation approach for proportions. 
<br>
<br>
<div class="small-text">**Status**: <span class="blB">Third</span> round of revisions</div>

<!-- ----------------------------------------------------------------- -->
## Background {.smaller}

::::: {.columns}

:::: {.column width="58%"}
::: {.incremental}
- Increasing demand $\to$ *robust* small area estimates from <span class="blB">smaller</span> surveys
- **Sparsity** is key <span class="blR">challenge</span> when working with **proportions**
  - Model-based SAE methods pushed to <span class="blR">extent</span>
  -  Individual level or area level models <span class="blR">cannot address</span>
:::
::::

:::: {.column width="38%"}
![](imgs/background.webp){.center}

::::

:::::
  
<!-- ----------------------------------------------------------------- -->
## {auto-animate=true}

::: {style="margin-top: 100px;"}
Use both?
:::

<!-- ----------------------------------------------------------------- -->
## {auto-animate=true}

::: {style="margin-top: 200px; font-size: 3em;"}
Use **both?**
:::

:::{.incremental}
- Two-stage approaches have <span class="blB">emerged</span> [@gao2023_sma;@Das2022]
- Recent work hints at <span class="blB">benefits</span> $\to$ <span class="blR">no full</span> investigation
- <span class="blB">Mitigate</span> weakness of either model and <span class="blB">leverage</span> their strengths
:::


<!-- ----------------------------------------------------------------- -->
## {.center}

::: {.quote-box}
**Contribution** ðŸŽ‰
<br>
<br>
A Bayesian two-stage method for proportions that tackles data sparsity challenges in small area estimation.
:::

<!-- ----------------------------------------------------------------- -->
## The two-stage logistic normal (TSLN) approach {.scrollable .smaller}

::::: {.columns}

:::: {.column width="48%"}
::: {.incremental}
- Stage 1 (TSLN-S1)
  - Fit a **individual-level** <span class="blB">logistic model</span> to the survey data
- Stage 1 (S1) estimates
  - Using fitted values calculate area-level <span class="blB">S1 estimates</span> and sampling variances
- Stage 2 (TSLN-S2)
  - **Smooth** <span class="blB">S1 estimates</span> and **impute** estimates for non-sampled areas using an **area-level** <span class="blB">Fay-Herriot [@RN54] model</span>
:::
::::

:::: {.column width="48%"}
![](imgs/TSLN_model_flowchart.png){width=210%}

::::

:::::

<!-- ----------------------------------------------------------------- -->
## The TSLN approach {.scrollable .smaller}

### Stage 1
Individual level logistic model
$$
\begin{eqnarray}
    y_{ij} &\sim& \text{Bernoulli}(p_{ij})^{\tilde{w}_{ij}}
    \\
    \text{logit}(p_{ij}) &=& \mathbf{x}_{ij} \boldsymbol{\beta} + e_i
    \\
    e_i &\sim& N(0, \sigma_e^2)
\end{eqnarray}
$$

where:

- $y_{ij}$ is the **binary response** for sampled individual $j$ in small area $i$
- $p_{ij}$ is the **probabilitiy** for $\dots$
- $\tilde{w}_{ij}$ is the sampled scaled **weight** for $\dots$

### Stage 1 (S1) estimates
The S1 estimate[^3] for area $i$ is,  
$$
\hat{\theta}_i^{\text{S1}} = \text{logit}\left( \frac{\sum_{j=1}^{n_i} w_{ij} p_{ij}}{n_i} \right)
$$
with $\gamma_i^{\text{S1}}$ is the corresponding sample variance.

where: 

- $w_{ij}$ is the sample **weight** for sampled individual $j$ in small area $i$
- Sample weights in small area $i$ sum to $n_i$ (the area sample size)

### Stage 2
The area level FH model is composed of: a
<br>
**measurement error** model, 
$$
\hat{\theta}_i^{\text{S1}} \sim N\lb{ \hat{\bar{\theta}}_i, \widehat{\text{v}}\lb{\hat{\theta}_i^{\text{S1}}} }, 
$$

which accommodates some of the uncertainty of the stage 1 model; a
<br>
**sampling model**,  

$$
\hat{\bar{\theta}}_i \sim N\lb{ \hat{\theta}_i, \gamma_i^{\text{S1}} },
$$

which accommodates the sampling variance; and a
<br>
**linking** model, 

$$
\begin{eqnarray}
    \hat{\theta}_i & = & \mathbf{Z}_{i} \boldsymbol{\lambda} + v_i
    \\
    v_i & \sim & N(0, \sigma_v^2), \nonumber
\end{eqnarray}
$$

The parameter of interest (i.e. proportion) is the posterior distribution of $\hat{\mu}_i = \text{logit}^{-1}( \hat{\theta}_i)$.
<br>

### Other considerations and additions

- Stability gained from smoothing (at individual level) balanced with aggreement with the direct estimates
- Generalized variance functions (GVF) for some of $\gamma_i^{\text{S1}}$

[^3]: The posterior draws from stage 1 are fed as input to the stage 2 model.

<!-- ----------------------------------------------------------------- -->
## Simulation study {.center .smaller}

Area level

- **BETA**: Beta model
- **ELN**: Empirical-logistic normal model
	- Similar to <span class="blB">stage 2</span> of the TSLN approach
- **BIN**: Binomial model
	- <span class="blR">Ignores</span> sample design

Individual level

- **LOG**: Pseudo-likelihood logistic model
	- Similar to <span class="blB">stage 1</span> of the TSLN approach
	
<!-- ----------------------------------------------------------------- -->
## Results

![](imgs/chp3/sparse_MRRMSE.png){.r-stretch}

<!-- ----------------------------------------------------------------- -->
## {.center}

:::{style="font-size: 0.5em;" .striped .hover}
|        |      | Sampled areas    |                  |           |           | Nonsampled areas |                  |           |           |
| :----- | :--- | :--------------- | :--------------- | :-------- | :-------- | :--------------- | :--------------- | :-------- | :-------- |
|        |      | MRRMSE           | MARB             | CI width  | Coverage  | MRRMSE           | MARB             | CI width  | Coverage  |
| 50-50  | BETA | 0\.36 (2.17)     | 0\.22 (1.96)     | 0\.46     | 0\.80     | 0\.40 (2.29)     | 0\.16 (1.35)     | 0\.61     | 1\.00     |
|        | BIN  | 0\.39 (2.38)     | 0\.38 (3.35)     | **0\.18** | 0\.03     | 0\.40 (2.30)     | 0\.38 (3.29)     | 0\.20     | 0\.03     |
|        | ELN  | 0\.34 (2.08)     | 0\.21 (1.84)     | 0\.43     | 0\.91     | 0\.40 (2.32)     | 0\.15 (1.32)     | 0\.64     | 1\.00     |
|        | LOG  | 0\.25 (1.52)     | 0\.16 (1.41)     | 0\.32     | 0\.90     | 0\.28 (1.61)     | **0\.10 (0.83)** | 0\.47     | 1\.00     |
|        | TSLN | **0\.17 (1.00)** | **0\.11 (1.00)** | 0\.22     | **0\.94** | **0\.17 (1.00)** | 0\.12 (1.00)     | 0\.23     | **0\.95** |
| Rare   | BETA | 0\.47 (1.46)     | 0\.31 (1.39)     | 0\.21     | 0\.66     | 0\.51 (1.57)     | 0\.22 (1.08)     | 0\.34     | **0\.97** |
|        | BIN  | 0\.50 (1.54)     | 0\.48 (2.16)     | **0\.12** | 0\.08     | 0\.50 (1.54)     | 0\.47 (2.29)     | **0\.13** | 0\.08     |
|        | ELN  | 0\.78 (2.42)     | 0\.55 (2.52)     | 0\.39     | 0\.68     | 1\.03 (3.17)     | 0\.20 (0.96)     | 0\.77     | 1\.00     |
|        | LOG  | 0\.50 (1.55)     | 0\.35 (1.60)     | 0\.28     | 0\.82     | 0\.55 (1.68)     | **0\.15 (0.73)** | 0\.43     | 1\.00     |
|        | TSLN | **0\.32 (1.00)** | **0\.22 (1.00)** | 0\.19     | **0\.86** | **0\.32 (1.00)** | 0\.21 (1.00)     | 0\.20     | 0\.88     |
| Common | BETA | 0\.16 (2.01)     | 0\.09 (1.76)     | 0\.31     | 0\.89     | 0\.18 (2.25)     | 0\.04 (0.87)     | 0\.43     | 1\.00     |
|        | BIN  | 0\.25 (3.13)     | 0\.24 (4.80)     | 0\.19     | 0\.05     | 0\.25 (3.04)     | 0\.23 (4.64)     | 0\.21     | 0\.08     |
|        | ELN  | 0\.12 (1.52)     | 0\.07 (1.37)     | 0\.26     | 0\.98     | 0\.13 (1.58)     | 0\.06 (1.18)     | 0\.31     | 1\.00     |
|        | LOG  | 0\.11 (1.40)     | 0\.06 (1.28)     | 0\.24     | **0\.97** | 0\.12 (1.45)     | **0\.05 (0.99)** | 0\.29     | 1\.00     |
|        | TSLN | **0\.08 (1.00)** | **0\.05 (1.00)** | **0\.16** | 0\.98     | **0\.08 (1.00)** | 0\.05 (1.00)     | 0\.17     | **0\.99** |
:::

<!-- ----------------------------------------------------------------- -->
## {.center .smaller}

:::: {.finding-box}
**Key findings** ðŸ“¢

::: {.incremental}
- TSLN approach provides <span class="blB">superior</span> proportion estimates.
	- Similar bias but much <span class="blB">smaller variance</span>.
	- Consistently <span class="blB">smaller MSEs</span> and credible intervals.
	- Interval <span class="blB">coverage more stable</span> and closer to the nominal level. 
- Appears to be the <span class="blB">best option</span> in sparse settings, such as when using the **NHS in Australia**
- Demonstrated benefits of <span class="blB">multi-stage smoothing</span> with the use of individual *and* area level models
:::

::::


